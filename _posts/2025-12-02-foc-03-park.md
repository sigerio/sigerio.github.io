---
layout: post
title: "帕克(Park)变换、反帕克变换和反克拉克变换"
date: 2025-12-02
category: 电力电子
tags: [FOC, 电力电子, 坐标变换, Park变换]
toc: true
---

## 专有名词解释

**Park变换（Park Transformation）**：将两相静止坐标系（αβ）转换为两相旋转坐标系（dq）的数学变换，是FOC算法的第二步坐标变换，也是实现"交流变直流"的关键步骤。

**dq坐标系（两相旋转坐标系）**：d轴与转子磁极对齐，q轴超前d轴90°电角度。与αβ坐标系不同，dq坐标系随转子同步旋转。

**电角度（$\theta$）**：转子磁极与α轴（定子A相轴）之间的夹角。电角度与机械角度的关系为 $\theta_e = P \cdot \theta_m$，其中P为极对数。

**$I_d$（D轴电流/励磁电流）**：产生与转子磁场同向的定子磁场。在PMSM控制中通常设为0，以最大化转矩效率。

**$I_q$（Q轴电流/转矩电流）**：产生与转子磁场正交的定子磁场，直接决定电机输出转矩。

**反Park变换（Inverse Park）**：从dq坐标系到αβ坐标系的逆变换，用于将控制器输出的电压参考值转换回静止坐标系。

**反Clark变换（Inverse Clarke）**：从αβ坐标系到ABC坐标系的逆变换，用于生成三相电压参考值。


## 三种变换的关系

FOC中的坐标变换形成一个完整的信号处理链路：

**正向变换链路（电流采样→控制器）**：
- ABC → αβ（Clark变换）：三相简化为两相
- αβ → dq（Park变换）：静止变为旋转，交流变为直流

**逆向变换链路（控制器→PWM输出）**：
- dq → αβ（反Park变换）：旋转变为静止
- αβ → ABC（反Clark变换）：两相恢复为三相

## Park变换的核心原理

### 为什么旋转坐标系能把交流变成直流

这是Park变换最神奇的地方。想象一下：

在αβ静止坐标系中，定子电流矢量以电角速度 $\omega_e$ 旋转。如果我们站在地面（静止坐标系）观察，看到的是一个旋转的矢量，其在α轴和β轴上的投影都是正弦变化的——这就是交流。

现在假设我们站在一个与电流矢量同步旋转的转盘上（旋转坐标系），从这个角度观察，电流矢量相对于我们是静止的！其在d轴和q轴上的投影都是恒定值——这就是直流。

**Park变换的本质**：通过建立一个与转子磁场同步旋转的坐标系，让观察者"跟着"电流矢量一起旋转，从而将交流量"看成"直流量。


## 电角度与机械角度的关系

**电角度（$\theta_e$）** 与 **机械角度（$\theta_m$）** 的关系：

$$\theta_e = P \cdot \theta_m$$

其中 $P$ 为电机的**极对数**。

### 为什么会有电角度和机械角度的区别

电机转子上通常有多对磁极。以4极电机（2对极）为例，转子机械旋转180°时，定子线圈经历的磁场变化相当于完整的一个电周期（360°电角度）。

不同极对数电机的电角度变化：
- 1对极（2极电机）：机械转一圈（360°），电角度变化360°
- 2对极（4极电机）：机械转一圈（360°），电角度变化720°
- 4对极（8极电机）：机械转一圈（360°），电角度变化1440°
- 7对极（14极电机）：机械转一圈（360°），电角度变化2520°

> 电角度是FOC控制的核心参数，由Hall传感器或无感算法（如EKF）获取。Park变换必须使用准确的电角度才能正确工作。

## $I_d$ 和 $I_q$ 的物理意义

### $I_d$（D轴电流/励磁电流）

**方向**：与转子永磁体磁场方向一致（d轴方向）。

**作用**：产生与转子磁场同向或反向的定子磁场。

**FOC控制策略**：在永磁同步电机（PMSM）控制中，通常采用 $I_d = 0$ 控制策略。

**设为0的原因**：
- PMSM已有永磁体提供励磁，无需额外的励磁电流
- 额外的励磁电流会增加铜损，降低效率
- 使所有定子电流都用于产生转矩，实现最大转矩电流比（MTPA）


### $I_q$（Q轴电流/转矩电流）

**方向**：与转子磁场正交，超前90°电角度（q轴方向）。

**作用**：与转子磁场交互产生电磁转矩。根据洛伦兹力原理，载流导体在磁场中受力，当电流方向与磁场垂直时，产生的力最大。

**转矩公式**：

$$T_e = \frac{3}{2} P \cdot \psi_f \cdot I_q$$

其中：
- $T_e$：电磁转矩
- $P$：极对数
- $\psi_f$：永磁体磁链
- $I_q$：Q轴电流

简化形式：$T_e = K_t \cdot I_q$（$K_t$为转矩常数）

**控制意义**：
- 增大 $I_q$ → 增大电磁转矩 → 电机加速
- 减小 $I_q$ → 减小电磁转矩 → 电机减速或制动

## Park变换公式

### 正向Park变换（αβ → dq）

$$ i_d = i_\alpha \cos\theta + i_\beta \sin\theta $$

$$ i_q = -i_\alpha \sin\theta + i_\beta \cos\theta $$

矩阵形式：

$$ \begin{bmatrix} i_d \\ i_q \end{bmatrix} = \begin{bmatrix} \cos\theta & \sin\theta \\ -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} i_\alpha \\ i_\beta \end{bmatrix} $$

其中 $\theta$ 为转子电角度。


## 反帕克变换

从dq坐标系往αβ坐标系进行变换，用于将PID控制器输出的电压参考值 $V_d$、$V_q$ 转换回静止坐标系：

$$ v_\alpha = v_d \cos\theta - v_q \sin\theta $$

$$ v_\beta = v_d \sin\theta + v_q \cos\theta $$

矩阵形式：

$$ \begin{bmatrix} v_\alpha \\ v_\beta \end{bmatrix} = \begin{bmatrix} \cos\theta & -\sin\theta \\ \sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} v_d \\ v_q \end{bmatrix} $$

> 注意：反Park变换的变换矩阵是正向Park变换矩阵的转置（也是其逆矩阵），这是因为旋转矩阵是正交矩阵。

## 反克拉克变换

从αβ坐标系往ABC三相坐标系变换，用于生成三相电压参考值供SVPWM使用：

$$ V_a = v_\alpha $$

$$ V_b = \frac{-v_\alpha + \sqrt{3} v_\beta}{2} $$

$$ V_c = \frac{-v_\alpha - \sqrt{3} v_\beta}{2} $$

### 推导过程

从几何投影关系出发：

$$ v_a = v_\alpha \cos 0° + v_\beta \cos 90° = v_\alpha $$

$$ v_b = -v_\alpha \sin 30° + v_\beta \cos 30° = -\frac{1}{2}v_\alpha + \frac{\sqrt{3}}{2}v_\beta $$

$$ v_c = -v_\alpha \sin 30° - v_\beta \cos 30° = -\frac{1}{2}v_\alpha - \frac{\sqrt{3}}{2}v_\beta $$

> 反Clark变换得到的三相电压参考值将送入SVPWM模块，生成最终的6路PWM信号驱动逆变器。
